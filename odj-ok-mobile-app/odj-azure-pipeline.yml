trigger: none
  # batch: true
  # paths:
  #   include:
  #   - odj-ok-mobile-app/*

resources:
  repositories:
  - repository: templates
    type: git
    ref: refs/heads/master
    name: schwarzit.odj-pipeline-templates/odj-deliver-templates

variables:
- group: odj-technical-product-properties
- group: odj-component-odj-ok-mobile-app-properties

extends:
  template: templates/technologies/generic/v2/odj-pipeline-template-technology-generic.yml@templates
  parameters:
    odj_devenv_static_code_analysis:
    - sonarqube_saas
    odj_devenv_pipeline: azuredevops  # Managed by ODJ, do not modify
    odj_devenv_code_repository: azuredevops  # Managed by ODJ, do not modify
    odj_runenv_component_type: deployable  # Managed by ODJ, do not modify
    doSourcecodeBuild:
    - template: templates/category/static-code-analysis/static-code-analysis-prepare.yml@templates
      parameters:
        odj_devenv_static_code_analysis:
        - sonarqube_saas
    
    - template: templates/category/static-code-analysis/static-code-analysis.yml@templates
      parameters:
        odj_devenv_static_code_analysis:
        - sonarqube_saas
    productive_branch: refs/heads/main
    ${{ if eq(variables['Build.SourceBranch'], 'refs/heads/main') }}:
      odj_deploy_stages:
      - prod
