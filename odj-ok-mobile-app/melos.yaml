name: ok_mobile_app

# Packages to be included into project by melos.
# apps/* means all packages in the apps folder.
# packages/** means all packages in the packages folder and all descendants.
packages:
  - apps/*
  - packages/**
 
# If user does not use InteliJ IDEA this can be set to false to prevent from generating specific configuration files.
ide:
  intellij: false

scripts:
  build:
    run: dart run build_runner build --delete-conflicting-outputs
    exec:
      concurrency: 1
    packageFilters:
      dependsOn: build_runner

  upgrade:
    run: dart pub upgrade
    exec: 
      concurrency: 1

  analyze:
    run: dart pub global run melos exec -- flutter analyze .
    description: Run `dart analyze` in all packages.

  format:
    run: dart pub global run melos exec -- dart format lib --set-exit-if-changed
    description: Run `dart analyze` in all packages.

  test:selective_unit_test:
    run: dart pub global run melos exec --dir-exists="test" --fail-fast -- flutter test --no-pub --coverage
    description: Run Flutter tests for a specific package in this project.
    packageFilters:
      flutter: true
      dirExists: test

  test:
    run: dart pub global run melos run test:selective_unit_test --no-select
    description: Run all Flutter tests in this project.

command:
  bootstrap:
    # It seems so that running "pub get" in parallel has some issues (like
    # https://github.com/dart-lang/pub/issues/3404). Disabling this feature
    # makes the CI much more stable.
    runPubGetInParallel: false